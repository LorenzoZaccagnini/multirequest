# multirequest

This is a program in GO that makes multiple HTTP GET request taking the URLs from a text file. The multiple requests are made concurrently using **[Goroutines](https://go.dev/doc/effective_go#goroutines)**.

## How to run

Open your favorite **Terminal** and run this command:

```sh
go run main.go
```

### CLI docs

The program can be run with the following options:

```sh
Usage of multirequest:
  -f string
        File path (default "urls.txt")
  -h string
```

for example:

```sh
go run main.go -f "./my_other_urls.txt"
```

or for example on Windows using the executable:

```sh
multirequest.exe -f "./my_other_urls.txt"
```

## Test

```sh
go test -v ./...
```

The client_test.go file contains the tests for the client.go file. Mocks valid and invalid http response, generated by using **[httptest](https://pkg.go.dev/net/http/httptest)**.

The scanner_test.go file contains the tests for the scanner.go file. Tests the reading of the file and the parsing of the urls.

Both are tested using [table driven tests](https://dave.cheney.net/2019/05/07/prefer-table-driven-tests).

## Coverage

client and scanner files are fully covered 100% by tests.

you can check the coverage by running:

```sh
go test -cover ./...
```

Other files are not covered by tests, this is because they are not part of the core logic of the program.

## Build

```sh
go build
```

## Github Actions

The github actions are defined in the [test.yml](.github/workflows/test.yml) file. The actions are triggered on every push, testing and building the code.

#### JSONL file

The results of each http connection and user action, with the timestamp of the http response code, are written into a [JSONL file](https://jsonlines.org/). This kind of format is useful for streaming data, and it is also easy to parse. It is possible to check some example logs in the [example_logs_result](example_logs_result) folder.

#### Logging framework

**Logging** is handled by using **[Zerolog](https://pkg.go.dev/github.com/rs/zerolog)** that has the [best performance in the Go envirovment](https://github.com/rs/zerolog#benchmarks)

#### HTTP testing

- Mock HTTP responses are generated by using **[httptest](https://pkg.go.dev/net/http/httptest)**

#### Docker

The solution is dockerized by using **[Docker](https://www.docker.com/)**. Build a **Docker image** named multirequest based on the instructions in the [Dockerfile]():

```sh
docker build -t multirequest .
```

Use the docker run command to start a **Docker container** from the image:

```sh
go

docker run -p 8080:8080 multirequest
```

## Tech used

- [Go lang v1.19](https://go.dev/)
- [Zerolog](https://pkg.go.dev/github.com/rs/zerolog)
- [httptest](https://pkg.go.dev/net/http/httptest)
- [Docker](https://www.docker.com/)

## Contributors

Thanks goes to these wonderful people:

<!-- ALL-CONTRIBUTORS-LIST:START - Do not remove or modify this section -->
<!-- prettier-ignore-start -->
<!-- markdownlint-disable -->
<table>
    <td align="center"><a href=" "><img src="https://avatars.githubusercontent.com/u/18169376?s=96&v=4" width="100px;" alt=""/><br /><sub><b>Lorenzo Zaccagnini</b></sub></a><br /><a href="https://it.linkedin.com/in/lorenzo-zaccagnini" title="LinkedIn">ðŸ’¬</a> <a href="https://github.com/LorenzoZaccagnini" title="GitHub">ðŸ“–</a></td>
</table>
<!-- markdownlint-enable -->
<!-- prettier-ignore-end -->
<!-- ALL-CONTRIBUTORS-LIST:END -->
